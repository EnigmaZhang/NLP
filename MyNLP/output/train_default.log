2020-05-25 11:35:55.449757: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:187: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\research\neural_stack.py:52: The name tf.nn.rnn_cell.RNNCell is deprecated. Please use tf.compat.v1.nn.rnn_cell.RNNCell instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:111: The name tf.OptimizerOptions is deprecated. Please use tf.compat.v1.OptimizerOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:111: The name tf.OptimizerOptions is deprecated. Please use tf.compat.v1.OptimizerOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_gan\python\estimator\tpu_gan_estimator.py:42: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_gan\python\estimator\tpu_gan_estimator.py:42: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:33: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:33: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

INFO:tensorflow:Importing user module usr_dir from path C:\Users\zhang\OneDrive\Desktop\NLP\MyNLP
I0525 11:36:04.328691 20560 usr_dir.py:43] Importing user module usr_dir from path C:\Users\zhang\OneDrive\Desktop\NLP\MyNLP
INFO:tensorflow:Loading hparams from existing json ./output\hparams.json
I0525 11:36:04.328691 20560 hparams_lib.py:64] Loading hparams from existing json ./output\hparams.json
INFO:tensorflow:Overwrite key batch_size: 4096 -> 512
I0525 11:36:04.338823 20560 hparams_lib.py:86] Overwrite key batch_size: 4096 -> 512
INFO:tensorflow:Overriding hparams in transformer_small with batch_size=512
I0525 11:36:04.338823 20560 hparams_lib.py:55] Overriding hparams in transformer_small with batch_size=512
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:844: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

W0525 11:36:04.338823 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:844: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:123: The name tf.GraphOptions is deprecated. Please use tf.compat.v1.GraphOptions instead.

W0525 11:36:04.338823 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:123: The name tf.GraphOptions is deprecated. Please use tf.compat.v1.GraphOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:129: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

W0525 11:36:04.338823 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:129: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:131: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

W0525 11:36:04.338823 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:131: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:241: RunConfig.__init__ (from tensorflow.contrib.learn.python.learn.estimators.run_config) is deprecated and will be removed in a future version.
Instructions for updating:
When switching to tf.estimator.Estimator, use tf.estimator.RunConfig instead.
W0525 11:36:04.338823 20560 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:241: RunConfig.__init__ (from tensorflow.contrib.learn.python.learn.estimators.run_config) is deprecated and will be removed in a future version.
Instructions for updating:
When switching to tf.estimator.Estimator, use tf.estimator.RunConfig instead.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:264: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0525 11:36:04.338823 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:264: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:Configuring DataParallelism to replicate the model.
I0525 11:36:04.338823 20560 trainer_lib.py:264] Configuring DataParallelism to replicate the model.
INFO:tensorflow:schedule=train
I0525 11:36:04.338823 20560 devices.py:76] schedule=train
INFO:tensorflow:worker_gpu=1
I0525 11:36:04.338823 20560 devices.py:77] worker_gpu=1
INFO:tensorflow:sync=False
I0525 11:36:04.338823 20560 devices.py:78] sync=False
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\devices.py:139: The name tf.logging.warn is deprecated. Please use tf.compat.v1.logging.warn instead.

W0525 11:36:04.338823 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\devices.py:139: The name tf.logging.warn is deprecated. Please use tf.compat.v1.logging.warn instead.

WARNING:tensorflow:Schedule=train. Assuming that training is running on a single machine.
W0525 11:36:04.338823 20560 devices.py:141] Schedule=train. Assuming that training is running on a single machine.
INFO:tensorflow:datashard_devices: ['gpu:0']
I0525 11:36:04.338823 20560 devices.py:170] datashard_devices: ['gpu:0']
INFO:tensorflow:caching_devices: None
I0525 11:36:04.338823 20560 devices.py:171] caching_devices: None
INFO:tensorflow:ps_devices: ['gpu:0']
I0525 11:36:04.338823 20560 devices.py:172] ps_devices: ['gpu:0']
I0525 11:36:04.338823 20560 merge_vocab.py:101] Loading and processing vocabulary from: C:\Users\zhang\OneDrive\Desktop\NLP\MyNLP\usr_dir/merge.txt.vocab.clean
I0525 11:36:04.338823 20560 merge_vocab.py:105] Done
INFO:tensorflow:Using config: {'_task_type': None, '_task_id': 0, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x000001AE7BDD3108>, '_master': '', '_num_ps_replicas': 0, '_num_worker_replicas': 0, '_environment': 'local', '_is_chief': True, '_evaluation_master': '', '_train_distribute': None, '_eval_distribute': None, '_experimental_max_worker_delay_secs': None, '_device_fn': None, '_tf_config': gpu_options {
  per_process_gpu_memory_fraction: 1.0
}
, '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_secs': 1800, '_log_step_count_steps': 100, '_protocol': None, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.95
}
allow_soft_placement: true
graph_options {
  optimizer_options {
    global_jit_level: OFF
  }
}
isolate_session_state: true
, '_save_checkpoints_steps': None, '_keep_checkpoint_max': 1000, '_keep_checkpoint_every_n_hours': 10000, '_model_dir': './output', '_session_creation_timeout_secs': 7200, 'use_tpu': False, 't2t_device_info': {'num_async_replicas': 1}, 'data_parallelism': <tensor2tensor.utils.expert_utils.Parallelism object at 0x000001AE7C4CEE08>}
I0525 11:36:04.348913 20560 estimator.py:212] Using config: {'_task_type': None, '_task_id': 0, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x000001AE7BDD3108>, '_master': '', '_num_ps_replicas': 0, '_num_worker_replicas': 0, '_environment': 'local', '_is_chief': True, '_evaluation_master': '', '_train_distribute': None, '_eval_distribute': None, '_experimental_max_worker_delay_secs': None, '_device_fn': None, '_tf_config': gpu_options {
  per_process_gpu_memory_fraction: 1.0
}
, '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_secs': 1800, '_log_step_count_steps': 100, '_protocol': None, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.95
}
allow_soft_placement: true
graph_options {
  optimizer_options {
    global_jit_level: OFF
  }
}
isolate_session_state: true
, '_save_checkpoints_steps': None, '_keep_checkpoint_max': 1000, '_keep_checkpoint_every_n_hours': 10000, '_model_dir': './output', '_session_creation_timeout_secs': 7200, 'use_tpu': False, 't2t_device_info': {'num_async_replicas': 1}, 'data_parallelism': <tensor2tensor.utils.expert_utils.Parallelism object at 0x000001AE7C4CEE08>}
WARNING:tensorflow:Estimator's model_fn (<function T2TModel.make_estimator_model_fn.<locals>.wrapping_model_fn at 0x000001AE7C4B7D38>) includes params argument, but params are not passed to Estimator.
W0525 11:36:04.348913 20560 model_fn.py:630] Estimator's model_fn (<function T2TModel.make_estimator_model_fn.<locals>.wrapping_model_fn at 0x000001AE7C4B7D38>) includes params argument, but params are not passed to Estimator.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:331: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

W0525 11:36:04.348913 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:331: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:348: The name tf.gfile.Open is deprecated. Please use tf.io.gfile.GFile instead.

W0525 11:36:04.348913 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:348: The name tf.gfile.Open is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
W0525 11:36:04.368671 20560 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
INFO:tensorflow:Reading data files from ./data_dir\translate_up2down-train*
I0525 11:36:04.373677 20560 problem.py:651] Reading data files from ./data_dir\translate_up2down-train*
INFO:tensorflow:partition: 0 num_data_files: 9
I0525 11:36:04.378715 20560 problem.py:677] partition: 0 num_data_files: 9
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:687: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.experimental.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_determinstic`.
W0525 11:36:04.378715 20560 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:687: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.experimental.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_determinstic`.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:712: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0525 11:36:04.518917 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:712: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.logging.warning is deprecated. Please use tf.compat.v1.logging.warning instead.

W0525 11:36:04.908775 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.logging.warning is deprecated. Please use tf.compat.v1.logging.warning instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:276: tf_record_iterator (from tensorflow.python.lib.io.tf_record) is deprecated and will be removed in a future version.
Instructions for updating:
Use eager execution and: 
`tf.data.TFRecordDataset(path)`
W0525 11:36:06.018865 20560 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:276: tf_record_iterator (from tensorflow.python.lib.io.tf_record) is deprecated and will be removed in a future version.
Instructions for updating:
Use eager execution and: 
`tf.data.TFRecordDataset(path)`
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:38: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0525 11:36:06.257330 20560 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:38: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\data\experimental\ops\grouping.py:194: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0525 11:36:06.665854 20560 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\data\experimental\ops\grouping.py:194: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

W0525 11:36:07.460502 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:234: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0525 11:36:07.661997 20560 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:234: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0525 11:36:08.053810 20560 estimator.py:1148] Calling model_fn.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1991: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

W0525 11:36:08.053810 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1991: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1994: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

W0525 11:36:08.053810 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1994: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1997: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

W0525 11:36:08.053810 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1997: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1457: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

W0525 11:36:08.068979 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1457: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

INFO:tensorflow:Setting T2TModel mode to 'train'
I0525 11:36:08.068979 20560 t2t_model.py:2262] Setting T2TModel mode to 'train'
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:100: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0525 11:36:08.068979 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:100: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:245: The name tf.summary.text is deprecated. Please use tf.compat.v1.summary.text instead.

W0525 11:36:08.179033 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:245: The name tf.summary.text is deprecated. Please use tf.compat.v1.summary.text instead.

INFO:tensorflow:Using variable initializer: uniform_unit_scaling
I0525 11:36:09.288853 20560 api.py:332] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_3606_256.bottom
I0525 11:36:22.868803 20560 api.py:332] Transforming feature 'inputs' with symbol_modality_3606_256.bottom
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
W0525 11:36:23.559017 20560 deprecation.py:506] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0525 11:36:23.838673 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

INFO:tensorflow:Transforming feature 'targets' with symbol_modality_3606_256.targets_bottom
I0525 11:36:26.238794 20560 api.py:332] Transforming feature 'targets' with symbol_modality_3606_256.targets_bottom
INFO:tensorflow:Building model body
I0525 11:36:26.471675 20560 api.py:332] Building model body
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.mod is deprecated. Please use tf.math.mod instead.

W0525 11:36:30.039400 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.mod is deprecated. Please use tf.math.mod instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py:95: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0525 11:36:30.268754 20560 deprecation.py:506] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py:95: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:Entity <function attention_bias_to_padding at 0x000001AE756F2CA8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 
W0525 11:36:31.358879 20560 ag_logging.py:146] Entity <function attention_bias_to_padding at 0x000001AE756F2CA8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.squared_difference is deprecated. Please use tf.math.squared_difference instead.

W0525 11:36:32.655048 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.squared_difference is deprecated. Please use tf.math.squared_difference instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.rsqrt is deprecated. Please use tf.math.rsqrt instead.

W0525 11:36:32.655048 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.rsqrt is deprecated. Please use tf.math.rsqrt instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

W0525 11:36:39.358969 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

W0525 11:36:39.358969 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:Entity <function layers at 0x000001AE6C077438> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: If not matching a CFG node, must be a block statement: <gast.gast.ImportFrom object at 0x000001AE7E595C48>
W0525 11:36:39.883999 20560 ag_logging.py:146] Entity <function layers at 0x000001AE6C077438> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: If not matching a CFG node, must be a block statement: <gast.gast.ImportFrom object at 0x000001AE7E595C48>
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:3083: The name tf.layers.Dense is deprecated. Please use tf.compat.v1.layers.Dense instead.

W0525 11:36:39.883999 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:3083: The name tf.layers.Dense is deprecated. Please use tf.compat.v1.layers.Dense instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.image is deprecated. Please use tf.compat.v1.summary.image instead.

W0525 11:36:41.318798 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.image is deprecated. Please use tf.compat.v1.summary.image instead.

INFO:tensorflow:Transforming body output with symbol_modality_3606_256.top
I0525 11:36:51.198946 20560 api.py:332] Transforming body output with symbol_modality_3606_256.top
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

W0525 11:36:53.089014 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.log is deprecated. Please use tf.math.log instead.

W0525 11:36:57.569003 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.log is deprecated. Please use tf.math.log instead.

INFO:tensorflow:Base learning rate: 2.000000
I0525 11:36:59.778926 20560 learning_rate.py:29] Base learning rate: 2.000000
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:250: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

W0525 11:36:59.788723 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:250: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

INFO:tensorflow:Trainable Variables Total size: 4612608
I0525 11:36:59.798806 20560 optimize.py:336] Trainable Variables Total size: 4612608
INFO:tensorflow:Non-trainable variables Total size: 5
I0525 11:36:59.798806 20560 optimize.py:336] Non-trainable variables Total size: 5
INFO:tensorflow:Using optimizer adam
I0525 11:36:59.798806 20560 optimize.py:191] Using optimizer adam
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:102: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

W0525 11:36:59.803825 20560 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:102: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

INFO:tensorflow:Done calling model_fn.
I0525 11:37:05.115033 20560 estimator.py:1150] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
I0525 11:37:05.115033 20560 basic_session_run_hooks.py:541] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
I0525 11:37:21.418575 20560 monitored_session.py:240] Graph was finalized.
2020-05-25 11:37:21.422950: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2
2020-05-25 11:37:21.429445: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll
2020-05-25 11:37:22.137405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce MX150 major: 6 minor: 1 memoryClockRate(GHz): 1.0375
pciBusID: 0000:01:00.0
2020-05-25 11:37:22.137863: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-05-25 11:37:22.144884: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-05-25 11:37:22.152405: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-05-25 11:37:22.155583: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-05-25 11:37:22.166017: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-05-25 11:37:22.172383: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-05-25 11:37:22.198716: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-05-25 11:37:22.206666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-05-25 11:37:23.084748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-25 11:37:23.085089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-05-25 11:37:23.085286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-05-25 11:37:23.086409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 1945 MB memory) -> physical GPU (device: 0, name: GeForce MX150, pci bus id: 0000:01:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from ./output\model.ckpt-0
I0525 11:37:23.088578 20560 saver.py:1284] Restoring parameters from ./output\model.ckpt-0
2020-05-25 11:37:23.961048: I tensorflow/stream_executor/cuda/cuda_driver.cc:831] failed to allocate 1.90G (2040109312 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-05-25 11:37:23.961599: I tensorflow/stream_executor/cuda/cuda_driver.cc:831] failed to allocate 1.71G (1836098304 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\saver.py:1069: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
W0525 11:37:24.188774 20560 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\saver.py:1069: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
INFO:tensorflow:Running local_init_op.
I0525 11:37:24.691789 20560 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0525 11:37:24.938164 20560 session_manager.py:502] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into ./output\model.ckpt.
I0525 11:37:48.623485 20560 basic_session_run_hooks.py:606] Saving checkpoints for 0 into ./output\model.ckpt.
2020-05-25 11:38:04.706939: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-05-25 11:38:05.083450: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.088860: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.089252: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.089879: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.090338: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.090795: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.094659: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.095311: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.105990: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.106396: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.108599: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.111341: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.111952: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.112448: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.114154: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.116868: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.121324: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.125822: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.127644: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.128666: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.129456: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.146914: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.161161: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.165465: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.180030: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.181910: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.183201: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.187032: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.189519: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.191694: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.193829: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.194940: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.196871: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.203751: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.204275: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.208252: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.208768: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.209490: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.210039: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.211829: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.212452: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.213411: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.214097: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.215408: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.216128: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.217048: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.217683: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.220719: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.221412: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.222285: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.222935: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.224239: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.224972: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.225767: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.226428: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.228623: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.229302: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.230364: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.231008: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.232699: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.233376: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.234222: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.234870: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.235818: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.236294: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.236949: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.237480: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.240593: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.241320: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.242193: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.242812: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.243983: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.244684: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.245577: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.246310: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.248348: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.248899: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.250173: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.251294: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.253959: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.254521: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.255366: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.256089: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.257773: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.258306: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.259120: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.259770: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.261654: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.262139: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.263003: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.263510: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.265015: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.265507: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.266209: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.266862: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.268844: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.269394: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.270114: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:05.270648: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:12.039478: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:12.041011: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:38:12.041695: W tensorflow/stream_executor/stream.cc:2041] attempting to perform BLAS operation using StreamExecutor without BLAS support
2020-05-25 11:38:12.041152: W tensorflow/stream_executor/stream.cc:2041] attempting to perform BLAS operation using StreamExecutor without BLAS support
Traceback (most recent call last):
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1365, in _do_call
    return fn(*args)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1350, in _run_fn
    target_list, run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1443, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InternalError: 2 root error(s) found.
  (0) Internal: Blas GEMM launch failed : a.shape=(486, 256), b.shape=(256, 256), m=486, n=256, k=256
	 [[{{node transformer/parallel_0_5/transformer/transformer/body/encoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul}}]]
	 [[transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/encdec_attention/multihead_attention/dot_product_attention/Max/_2299]]
  (1) Internal: Blas GEMM launch failed : a.shape=(486, 256), b.shape=(256, 256), m=486, n=256, k=256
	 [[{{node transformer/parallel_0_5/transformer/transformer/body/encoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:/Anaconda/envs/NLP/Scripts/t2t-trainer", line 33, in <module>
    tf.app.run()
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\platform\app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "D:\Anaconda\envs\NLP\lib\site-packages\absl\app.py", line 299, in run
    _run_main(main, args)
  File "D:\Anaconda\envs\NLP\lib\site-packages\absl\app.py", line 250, in _run_main
    sys.exit(main(argv))
  File "D:/Anaconda/envs/NLP/Scripts/t2t-trainer", line 28, in main
    t2t_trainer.main(argv)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py", line 418, in main
    execute_schedule(exp)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py", line 371, in execute_schedule
    getattr(exp, FLAGS.schedule)()
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py", line 477, in train
    max_steps=max_steps or self._train_spec.max_steps)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1161, in _train_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1195, in _train_model_default
    saving_listeners)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1494, in _train_with_estimator_spec
    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 754, in run
    run_metadata=run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1259, in run
    run_metadata=run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1360, in run
    raise six.reraise(*original_exc_info)
  File "D:\Anaconda\envs\NLP\lib\site-packages\six.py", line 703, in reraise
    raise value
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1345, in run
    return self._sess.run(*args, **kwargs)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1418, in run
    run_metadata=run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1176, in run
    return self._sess.run(*args, **kwargs)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 956, in run
    run_metadata_ptr)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1180, in _run
    feed_dict_tensor, options, run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1359, in _do_run
    run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1384, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InternalError: 2 root error(s) found.
  (0) Internal: Blas GEMM launch failed : a.shape=(486, 256), b.shape=(256, 256), m=486, n=256, k=256
	 [[node transformer/parallel_0_5/transformer/transformer/body/encoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul (defined at \Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py:1748) ]]
	 [[transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/encdec_attention/multihead_attention/dot_product_attention/Max/_2299]]
  (1) Internal: Blas GEMM launch failed : a.shape=(486, 256), b.shape=(256, 256), m=486, n=256, k=256
	 [[node transformer/parallel_0_5/transformer/transformer/body/encoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul (defined at \Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py:1748) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'transformer/parallel_0_5/transformer/transformer/body/encoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul':
  File "/Anaconda/envs/NLP/Scripts/t2t-trainer", line 33, in <module>
    tf.app.run()
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\platform\app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "\Anaconda\envs\NLP\lib\site-packages\absl\app.py", line 299, in run
    _run_main(main, args)
  File "\Anaconda\envs\NLP\lib\site-packages\absl\app.py", line 250, in _run_main
    sys.exit(main(argv))
  File "/Anaconda/envs/NLP/Scripts/t2t-trainer", line 28, in main
    t2t_trainer.main(argv)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py", line 418, in main
    execute_schedule(exp)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py", line 371, in execute_schedule
    getattr(exp, FLAGS.schedule)()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py", line 477, in train
    max_steps=max_steps or self._train_spec.max_steps)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1161, in _train_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1191, in _train_model_default
    features, labels, ModeKeys.TRAIN, self.config)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1149, in _call_model_fn
    model_fn_results = self._model_fn(features=features, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 1420, in wrapping_model_fn
    use_tpu=use_tpu)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 1485, in estimator_model_fn
    logits, losses_dict = model(features)  # pylint: disable=not-callable
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\layers\base.py", line 548, in __call__
    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\keras\engine\base_layer.py", line 854, in __call__
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 325, in call
    sharded_logits, losses = self.model_fn_sharded(sharded_features)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 365, in model_fn_sharded
    if self.use_body_sharded():
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 402, in model_fn_sharded
    sharded_logits, sharded_losses = dp(self.model_fn, datashard_to_features)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\expert_utils.py", line 171, in __call__
    for i in range(self.n):
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 339, in for_stmt
    return _py_for_stmt(iter_, extra_test, body, get_state, set_state, init_vars)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 350, in _py_for_stmt
    state = body(target, *state)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\expert_utils.py", line 229, in __call__
    if self._devices[i] != DEFAULT_DEV_STRING:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\expert_utils.py", line 231, in __call__
    outputs.append(fns[i](*my_args[i], **my_kwargs[i]))
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 429, in model_fn
    body_out = self.body(transformed_features)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 243, in body
    if self.has_input:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 246, in body
    encoder_output, encoder_decoder_attention_bias = self.encode(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 200, in encode
    return transformer_encode(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 103, in transformer_encode
    encoder_output = encoder_function(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\transformer_layers.py", line 201, in transformer_encoder
    for layer in range(hparams.num_encoder_layers or hparams.num_hidden_layers):
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 339, in for_stmt
    return _py_for_stmt(iter_, extra_test, body, get_state, set_state, init_vars)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 350, in _py_for_stmt
    state = body(target, *state)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\transformer_layers.py", line 212, in transformer_encoder
    y = common_attention.multihead_attention(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4649, in multihead_attention
    if cache is None or memory_antecedent is None:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4650, in multihead_attention
    q, k, v = compute_qkv(query_antecedent, memory_antecedent,
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4454, in compute_qkv
    q = compute_attention_component(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4399, in compute_attention_component
    if vars_3d_num_heads > 0:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4414, in compute_attention_component
    if filter_width == 1:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4415, in compute_attention_component
    return common_layers.dense(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py", line 3083, in dense
    activations = layers().Dense(units, **kwargs)(x)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\layers\base.py", line 548, in __call__
    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\keras\engine\base_layer.py", line 854, in __call__
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\keras\layers\core.py", line 1039, in call
    outputs = standard_ops.tensordot(inputs, self.kernel, [[rank - 1], [0]])
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\math_ops.py", line 4071, in tensordot
    ab_matmul = matmul(a_reshape, b_reshape)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\util\dispatch.py", line 180, in wrapper
    return target(*args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\math_ops.py", line 2754, in matmul
    a, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\gen_math_ops.py", line 6136, in mat_mul
    name=name)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\op_def_library.py", line 794, in _apply_op_helper
    op_def=op_def)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\util\deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py", line 3357, in create_op
    attrs, op_def, compute_device)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py", line 3426, in _create_op_internal
    op_def=op_def)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

2020-05-25 11:44:22.690611: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:187: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\research\neural_stack.py:52: The name tf.nn.rnn_cell.RNNCell is deprecated. Please use tf.compat.v1.nn.rnn_cell.RNNCell instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:111: The name tf.OptimizerOptions is deprecated. Please use tf.compat.v1.OptimizerOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:111: The name tf.OptimizerOptions is deprecated. Please use tf.compat.v1.OptimizerOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_gan\python\estimator\tpu_gan_estimator.py:42: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_gan\python\estimator\tpu_gan_estimator.py:42: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:33: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:33: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

INFO:tensorflow:Importing user module usr_dir from path C:\Users\zhang\OneDrive\Desktop\NLP\MyNLP
I0525 11:44:31.598108 17848 usr_dir.py:43] Importing user module usr_dir from path C:\Users\zhang\OneDrive\Desktop\NLP\MyNLP
INFO:tensorflow:Loading hparams from existing json ./output\hparams.json
I0525 11:44:31.608179 17848 hparams_lib.py:64] Loading hparams from existing json ./output\hparams.json
INFO:tensorflow:Overwrite key batch_size: 4096 -> 512
I0525 11:44:31.608179 17848 hparams_lib.py:86] Overwrite key batch_size: 4096 -> 512
INFO:tensorflow:Overriding hparams in transformer_small with batch_size=256
I0525 11:44:31.608179 17848 hparams_lib.py:55] Overriding hparams in transformer_small with batch_size=256
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:844: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

W0525 11:44:31.608179 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:844: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:123: The name tf.GraphOptions is deprecated. Please use tf.compat.v1.GraphOptions instead.

W0525 11:44:31.608179 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:123: The name tf.GraphOptions is deprecated. Please use tf.compat.v1.GraphOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:129: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

W0525 11:44:31.608179 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:129: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:131: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

W0525 11:44:31.608179 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:131: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:241: RunConfig.__init__ (from tensorflow.contrib.learn.python.learn.estimators.run_config) is deprecated and will be removed in a future version.
Instructions for updating:
When switching to tf.estimator.Estimator, use tf.estimator.RunConfig instead.
W0525 11:44:31.613249 17848 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:241: RunConfig.__init__ (from tensorflow.contrib.learn.python.learn.estimators.run_config) is deprecated and will be removed in a future version.
Instructions for updating:
When switching to tf.estimator.Estimator, use tf.estimator.RunConfig instead.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:264: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0525 11:44:31.613249 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:264: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:Configuring DataParallelism to replicate the model.
I0525 11:44:31.613249 17848 trainer_lib.py:264] Configuring DataParallelism to replicate the model.
INFO:tensorflow:schedule=train
I0525 11:44:31.613249 17848 devices.py:76] schedule=train
INFO:tensorflow:worker_gpu=1
I0525 11:44:31.613249 17848 devices.py:77] worker_gpu=1
INFO:tensorflow:sync=False
I0525 11:44:31.613249 17848 devices.py:78] sync=False
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\devices.py:139: The name tf.logging.warn is deprecated. Please use tf.compat.v1.logging.warn instead.

W0525 11:44:31.613249 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\devices.py:139: The name tf.logging.warn is deprecated. Please use tf.compat.v1.logging.warn instead.

WARNING:tensorflow:Schedule=train. Assuming that training is running on a single machine.
W0525 11:44:31.613249 17848 devices.py:141] Schedule=train. Assuming that training is running on a single machine.
INFO:tensorflow:datashard_devices: ['gpu:0']
I0525 11:44:31.613249 17848 devices.py:170] datashard_devices: ['gpu:0']
INFO:tensorflow:caching_devices: None
I0525 11:44:31.613249 17848 devices.py:171] caching_devices: None
INFO:tensorflow:ps_devices: ['gpu:0']
I0525 11:44:31.613249 17848 devices.py:172] ps_devices: ['gpu:0']
I0525 11:44:31.613249 17848 merge_vocab.py:101] Loading and processing vocabulary from: C:\Users\zhang\OneDrive\Desktop\NLP\MyNLP\usr_dir/merge.txt.vocab.clean
I0525 11:44:31.613249 17848 merge_vocab.py:105] Done
INFO:tensorflow:Using config: {'_task_type': None, '_task_id': 0, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x0000026B408B4248>, '_master': '', '_num_ps_replicas': 0, '_num_worker_replicas': 0, '_environment': 'local', '_is_chief': True, '_evaluation_master': '', '_train_distribute': None, '_eval_distribute': None, '_experimental_max_worker_delay_secs': None, '_device_fn': None, '_tf_config': gpu_options {
  per_process_gpu_memory_fraction: 1.0
}
, '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_secs': 1800, '_log_step_count_steps': 100, '_protocol': None, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.95
}
allow_soft_placement: true
graph_options {
  optimizer_options {
    global_jit_level: OFF
  }
}
isolate_session_state: true
, '_save_checkpoints_steps': None, '_keep_checkpoint_max': 1000, '_keep_checkpoint_every_n_hours': 10000, '_model_dir': './output', '_session_creation_timeout_secs': 7200, 'use_tpu': False, 't2t_device_info': {'num_async_replicas': 1}, 'data_parallelism': <tensor2tensor.utils.expert_utils.Parallelism object at 0x0000026B409BE5C8>}
I0525 11:44:31.613249 17848 estimator.py:212] Using config: {'_task_type': None, '_task_id': 0, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x0000026B408B4248>, '_master': '', '_num_ps_replicas': 0, '_num_worker_replicas': 0, '_environment': 'local', '_is_chief': True, '_evaluation_master': '', '_train_distribute': None, '_eval_distribute': None, '_experimental_max_worker_delay_secs': None, '_device_fn': None, '_tf_config': gpu_options {
  per_process_gpu_memory_fraction: 1.0
}
, '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_secs': 1800, '_log_step_count_steps': 100, '_protocol': None, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.95
}
allow_soft_placement: true
graph_options {
  optimizer_options {
    global_jit_level: OFF
  }
}
isolate_session_state: true
, '_save_checkpoints_steps': None, '_keep_checkpoint_max': 1000, '_keep_checkpoint_every_n_hours': 10000, '_model_dir': './output', '_session_creation_timeout_secs': 7200, 'use_tpu': False, 't2t_device_info': {'num_async_replicas': 1}, 'data_parallelism': <tensor2tensor.utils.expert_utils.Parallelism object at 0x0000026B409BE5C8>}
WARNING:tensorflow:Estimator's model_fn (<function T2TModel.make_estimator_model_fn.<locals>.wrapping_model_fn at 0x0000026B409A7D38>) includes params argument, but params are not passed to Estimator.
W0525 11:44:31.613249 17848 model_fn.py:630] Estimator's model_fn (<function T2TModel.make_estimator_model_fn.<locals>.wrapping_model_fn at 0x0000026B409A7D38>) includes params argument, but params are not passed to Estimator.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:331: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

W0525 11:44:31.617823 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:331: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:348: The name tf.gfile.Open is deprecated. Please use tf.io.gfile.GFile instead.

W0525 11:44:31.617823 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:348: The name tf.gfile.Open is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
W0525 11:44:31.642803 17848 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
INFO:tensorflow:Reading data files from ./data_dir\translate_up2down-train*
I0525 11:44:31.658188 17848 problem.py:651] Reading data files from ./data_dir\translate_up2down-train*
INFO:tensorflow:partition: 0 num_data_files: 9
I0525 11:44:31.658188 17848 problem.py:677] partition: 0 num_data_files: 9
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:687: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.experimental.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_determinstic`.
W0525 11:44:31.667818 17848 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:687: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.experimental.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_determinstic`.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:712: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0525 11:44:31.838173 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:712: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.logging.warning is deprecated. Please use tf.compat.v1.logging.warning instead.

W0525 11:44:32.272729 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.logging.warning is deprecated. Please use tf.compat.v1.logging.warning instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:276: tf_record_iterator (from tensorflow.python.lib.io.tf_record) is deprecated and will be removed in a future version.
Instructions for updating:
Use eager execution and: 
`tf.data.TFRecordDataset(path)`
W0525 11:44:33.528049 17848 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:276: tf_record_iterator (from tensorflow.python.lib.io.tf_record) is deprecated and will be removed in a future version.
Instructions for updating:
Use eager execution and: 
`tf.data.TFRecordDataset(path)`
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:38: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0525 11:44:33.778177 17848 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:38: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\data\experimental\ops\grouping.py:194: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0525 11:44:34.208062 17848 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\data\experimental\ops\grouping.py:194: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

W0525 11:44:34.963116 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:234: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0525 11:44:35.208084 17848 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:234: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0525 11:44:35.637866 17848 estimator.py:1148] Calling model_fn.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1991: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

W0525 11:44:35.637866 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1991: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1994: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

W0525 11:44:35.637866 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1994: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1997: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

W0525 11:44:35.637866 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1997: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1457: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

W0525 11:44:35.668144 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1457: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

INFO:tensorflow:Setting T2TModel mode to 'train'
I0525 11:44:35.668144 17848 t2t_model.py:2262] Setting T2TModel mode to 'train'
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:100: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0525 11:44:35.668144 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:100: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:245: The name tf.summary.text is deprecated. Please use tf.compat.v1.summary.text instead.

W0525 11:44:35.817705 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:245: The name tf.summary.text is deprecated. Please use tf.compat.v1.summary.text instead.

INFO:tensorflow:Using variable initializer: uniform_unit_scaling
I0525 11:44:36.997971 17848 api.py:332] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_3606_256.bottom
I0525 11:44:49.758032 17848 api.py:332] Transforming feature 'inputs' with symbol_modality_3606_256.bottom
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
W0525 11:44:50.542807 17848 deprecation.py:506] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0525 11:44:50.907871 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

INFO:tensorflow:Transforming feature 'targets' with symbol_modality_3606_256.targets_bottom
I0525 11:44:53.358108 17848 api.py:332] Transforming feature 'targets' with symbol_modality_3606_256.targets_bottom
INFO:tensorflow:Building model body
I0525 11:44:53.526788 17848 api.py:332] Building model body
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.mod is deprecated. Please use tf.math.mod instead.

W0525 11:44:57.127715 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.mod is deprecated. Please use tf.math.mod instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py:95: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0525 11:44:57.418074 17848 deprecation.py:506] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py:95: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:Entity <function attention_bias_to_padding at 0x0000026B39BD2CA8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 
W0525 11:44:58.597810 17848 ag_logging.py:146] Entity <function attention_bias_to_padding at 0x0000026B39BD2CA8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.squared_difference is deprecated. Please use tf.math.squared_difference instead.

W0525 11:44:59.988880 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.squared_difference is deprecated. Please use tf.math.squared_difference instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.rsqrt is deprecated. Please use tf.math.rsqrt instead.

W0525 11:44:59.989913 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.rsqrt is deprecated. Please use tf.math.rsqrt instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

W0525 11:45:06.197767 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

W0525 11:45:06.197767 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:Entity <function layers at 0x0000026B30567438> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: If not matching a CFG node, must be a block statement: <gast.gast.ImportFrom object at 0x0000026B42124F08>
W0525 11:45:06.597766 17848 ag_logging.py:146] Entity <function layers at 0x0000026B30567438> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: If not matching a CFG node, must be a block statement: <gast.gast.ImportFrom object at 0x0000026B42124F08>
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:3083: The name tf.layers.Dense is deprecated. Please use tf.compat.v1.layers.Dense instead.

W0525 11:45:06.597766 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:3083: The name tf.layers.Dense is deprecated. Please use tf.compat.v1.layers.Dense instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.image is deprecated. Please use tf.compat.v1.summary.image instead.

W0525 11:45:08.006417 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.image is deprecated. Please use tf.compat.v1.summary.image instead.

INFO:tensorflow:Transforming body output with symbol_modality_3606_256.top
I0525 11:45:18.272955 17848 api.py:332] Transforming body output with symbol_modality_3606_256.top
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

W0525 11:45:20.412981 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.log is deprecated. Please use tf.math.log instead.

W0525 11:45:26.032895 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.log is deprecated. Please use tf.math.log instead.

INFO:tensorflow:Base learning rate: 2.000000
I0525 11:45:28.408005 17848 learning_rate.py:29] Base learning rate: 2.000000
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:250: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

W0525 11:45:28.417720 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:250: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

INFO:tensorflow:Trainable Variables Total size: 4612608
I0525 11:45:28.427815 17848 optimize.py:336] Trainable Variables Total size: 4612608
INFO:tensorflow:Non-trainable variables Total size: 5
I0525 11:45:28.427815 17848 optimize.py:336] Non-trainable variables Total size: 5
INFO:tensorflow:Using optimizer adam
I0525 11:45:28.427815 17848 optimize.py:191] Using optimizer adam
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:102: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

W0525 11:45:28.427815 17848 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:102: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

INFO:tensorflow:Done calling model_fn.
I0525 11:45:33.427847 17848 estimator.py:1150] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
I0525 11:45:33.432853 17848 basic_session_run_hooks.py:541] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
I0525 11:45:47.667600 17848 monitored_session.py:240] Graph was finalized.
2020-05-25 11:45:47.672768: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2
2020-05-25 11:45:47.676840: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll
2020-05-25 11:45:48.283622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce MX150 major: 6 minor: 1 memoryClockRate(GHz): 1.0375
pciBusID: 0000:01:00.0
2020-05-25 11:45:48.284047: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-05-25 11:45:48.288443: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-05-25 11:45:48.291691: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-05-25 11:45:48.293137: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-05-25 11:45:48.297354: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-05-25 11:45:48.301002: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-05-25 11:45:48.311147: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-05-25 11:45:48.311980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-05-25 11:45:49.085783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-25 11:45:49.086246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-05-25 11:45:49.086477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-05-25 11:45:49.087488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 1945 MB memory) -> physical GPU (device: 0, name: GeForce MX150, pci bus id: 0000:01:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from ./output\model.ckpt-0
I0525 11:45:49.088093 17848 saver.py:1284] Restoring parameters from ./output\model.ckpt-0
2020-05-25 11:45:49.801794: I tensorflow/stream_executor/cuda/cuda_driver.cc:831] failed to allocate 1.90G (2040109312 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-05-25 11:45:49.802339: I tensorflow/stream_executor/cuda/cuda_driver.cc:831] failed to allocate 1.71G (1836098304 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\saver.py:1069: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
W0525 11:45:50.027596 17848 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\saver.py:1069: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
INFO:tensorflow:Running local_init_op.
I0525 11:45:50.427986 17848 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0525 11:45:50.652918 17848 session_manager.py:502] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into ./output\model.ckpt.
I0525 11:46:12.906447 17848 basic_session_run_hooks.py:606] Saving checkpoints for 0 into ./output\model.ckpt.
2020-05-25 11:46:26.874440: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-05-25 11:46:27.134903: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.135535: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.135926: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.136567: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.136941: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.137310: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.140509: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.141152: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.144308: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.144693: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.145666: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.147376: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.147951: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.148361: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.150188: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.152090: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.153040: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.154686: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.155050: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.155409: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.155766: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.157246: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.158880: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.159673: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.161235: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.161718: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.162085: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.163819: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.165394: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.166608: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.168238: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.169135: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.170510: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.171795: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.172191: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.173791: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.174198: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.174723: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.175118: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.176482: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.176878: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.177435: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.177824: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.178571: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.178960: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.179460: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.180008: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.181447: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.181946: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.182558: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.182963: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.183742: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.184339: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.184962: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.185484: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.187074: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.187574: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.188557: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.189179: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.190603: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.191020: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.191609: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.192026: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.192692: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.193229: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.193985: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.194454: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.196730: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.197265: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.197765: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.198278: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.199103: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.199707: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.200237: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.200728: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.202444: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.203105: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.203749: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.204155: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.206108: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.206535: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.207250: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.207675: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.208667: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.209217: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.209949: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.210416: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.211931: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.212363: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.213011: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.213485: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.215220: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.215650: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.216261: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.216688: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.217576: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.218280: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.219034: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:27.219610: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:29.284853: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:29.285459: W tensorflow/stream_executor/stream.cc:2041] attempting to perform BLAS operation using StreamExecutor without BLAS support
2020-05-25 11:46:29.285628: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:46:29.286490: W tensorflow/stream_executor/stream.cc:2041] attempting to perform BLAS operation using StreamExecutor without BLAS support
Traceback (most recent call last):
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1365, in _do_call
    return fn(*args)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1350, in _run_fn
    target_list, run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1443, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InternalError: 2 root error(s) found.
  (0) Internal: Blas GEMM launch failed : a.shape=(195, 256), b.shape=(256, 256), m=195, n=256, k=256
	 [[{{node transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul}}]]
	 [[transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/encdec_attention/multihead_attention/dot_product_attention/Max/_2299]]
  (1) Internal: Blas GEMM launch failed : a.shape=(195, 256), b.shape=(256, 256), m=195, n=256, k=256
	 [[{{node transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:/Anaconda/envs/NLP/Scripts/t2t-trainer", line 33, in <module>
    tf.app.run()
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\platform\app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "D:\Anaconda\envs\NLP\lib\site-packages\absl\app.py", line 299, in run
    _run_main(main, args)
  File "D:\Anaconda\envs\NLP\lib\site-packages\absl\app.py", line 250, in _run_main
    sys.exit(main(argv))
  File "D:/Anaconda/envs/NLP/Scripts/t2t-trainer", line 28, in main
    t2t_trainer.main(argv)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py", line 418, in main
    execute_schedule(exp)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py", line 371, in execute_schedule
    getattr(exp, FLAGS.schedule)()
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py", line 477, in train
    max_steps=max_steps or self._train_spec.max_steps)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1161, in _train_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1195, in _train_model_default
    saving_listeners)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1494, in _train_with_estimator_spec
    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 754, in run
    run_metadata=run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1259, in run
    run_metadata=run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1360, in run
    raise six.reraise(*original_exc_info)
  File "D:\Anaconda\envs\NLP\lib\site-packages\six.py", line 703, in reraise
    raise value
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1345, in run
    return self._sess.run(*args, **kwargs)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1418, in run
    run_metadata=run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1176, in run
    return self._sess.run(*args, **kwargs)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 956, in run
    run_metadata_ptr)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1180, in _run
    feed_dict_tensor, options, run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1359, in _do_run
    run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1384, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InternalError: 2 root error(s) found.
  (0) Internal: Blas GEMM launch failed : a.shape=(195, 256), b.shape=(256, 256), m=195, n=256, k=256
	 [[node transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul (defined at \Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py:1748) ]]
	 [[transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/encdec_attention/multihead_attention/dot_product_attention/Max/_2299]]
  (1) Internal: Blas GEMM launch failed : a.shape=(195, 256), b.shape=(256, 256), m=195, n=256, k=256
	 [[node transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul (defined at \Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py:1748) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul':
  File "/Anaconda/envs/NLP/Scripts/t2t-trainer", line 33, in <module>
    tf.app.run()
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\platform\app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "\Anaconda\envs\NLP\lib\site-packages\absl\app.py", line 299, in run
    _run_main(main, args)
  File "\Anaconda\envs\NLP\lib\site-packages\absl\app.py", line 250, in _run_main
    sys.exit(main(argv))
  File "/Anaconda/envs/NLP/Scripts/t2t-trainer", line 28, in main
    t2t_trainer.main(argv)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py", line 418, in main
    execute_schedule(exp)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py", line 371, in execute_schedule
    getattr(exp, FLAGS.schedule)()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py", line 477, in train
    max_steps=max_steps or self._train_spec.max_steps)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1161, in _train_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1191, in _train_model_default
    features, labels, ModeKeys.TRAIN, self.config)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1149, in _call_model_fn
    model_fn_results = self._model_fn(features=features, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 1420, in wrapping_model_fn
    use_tpu=use_tpu)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 1485, in estimator_model_fn
    logits, losses_dict = model(features)  # pylint: disable=not-callable
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\layers\base.py", line 548, in __call__
    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\keras\engine\base_layer.py", line 854, in __call__
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 325, in call
    sharded_logits, losses = self.model_fn_sharded(sharded_features)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 365, in model_fn_sharded
    if self.use_body_sharded():
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 402, in model_fn_sharded
    sharded_logits, sharded_losses = dp(self.model_fn, datashard_to_features)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\expert_utils.py", line 171, in __call__
    for i in range(self.n):
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 339, in for_stmt
    return _py_for_stmt(iter_, extra_test, body, get_state, set_state, init_vars)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 350, in _py_for_stmt
    state = body(target, *state)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\expert_utils.py", line 229, in __call__
    if self._devices[i] != DEFAULT_DEV_STRING:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\expert_utils.py", line 231, in __call__
    outputs.append(fns[i](*my_args[i], **my_kwargs[i]))
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 429, in model_fn
    body_out = self.body(transformed_features)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 277, in body
    decoder_output = self.decode(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 218, in decode
    return transformer_decode(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 161, in transformer_decode
    decoder_output = decoder_function(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 1664, in transformer_decoder
    for layer_idx in range(hparams.num_decoder_layers or
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 339, in for_stmt
    return _py_for_stmt(iter_, extra_test, body, get_state, set_state, init_vars)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 350, in _py_for_stmt
    state = body(target, *state)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 1666, in transformer_decoder
    x = transformer_decoder_layer(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 1561, in transformer_decoder_layer
    x, layer_cache = transformer_self_attention_layer(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 1465, in transformer_self_attention_layer
    y = common_attention.multihead_attention(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4649, in multihead_attention
    if cache is None or memory_antecedent is None:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4650, in multihead_attention
    q, k, v = compute_qkv(query_antecedent, memory_antecedent,
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4454, in compute_qkv
    q = compute_attention_component(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4399, in compute_attention_component
    if vars_3d_num_heads > 0:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4414, in compute_attention_component
    if filter_width == 1:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4415, in compute_attention_component
    return common_layers.dense(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py", line 3083, in dense
    activations = layers().Dense(units, **kwargs)(x)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\layers\base.py", line 548, in __call__
    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\keras\engine\base_layer.py", line 854, in __call__
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\keras\layers\core.py", line 1039, in call
    outputs = standard_ops.tensordot(inputs, self.kernel, [[rank - 1], [0]])
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\math_ops.py", line 4071, in tensordot
    ab_matmul = matmul(a_reshape, b_reshape)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\util\dispatch.py", line 180, in wrapper
    return target(*args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\math_ops.py", line 2754, in matmul
    a, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\gen_math_ops.py", line 6136, in mat_mul
    name=name)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\op_def_library.py", line 794, in _apply_op_helper
    op_def=op_def)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\util\deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py", line 3357, in create_op
    attrs, op_def, compute_device)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py", line 3426, in _create_op_internal
    op_def=op_def)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

2020-05-25 11:47:58.221930: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:187: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\research\neural_stack.py:52: The name tf.nn.rnn_cell.RNNCell is deprecated. Please use tf.compat.v1.nn.rnn_cell.RNNCell instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:111: The name tf.OptimizerOptions is deprecated. Please use tf.compat.v1.OptimizerOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:111: The name tf.OptimizerOptions is deprecated. Please use tf.compat.v1.OptimizerOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_gan\python\estimator\tpu_gan_estimator.py:42: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_gan\python\estimator\tpu_gan_estimator.py:42: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:33: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:33: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

INFO:tensorflow:Importing user module usr_dir from path C:\Users\zhang\OneDrive\Desktop\NLP\MyNLP
I0525 11:48:05.647732 15312 usr_dir.py:43] Importing user module usr_dir from path C:\Users\zhang\OneDrive\Desktop\NLP\MyNLP
INFO:tensorflow:Loading hparams from existing json ./output\hparams.json
I0525 11:48:05.647732 15312 hparams_lib.py:64] Loading hparams from existing json ./output\hparams.json
INFO:tensorflow:Overwrite key batch_size: 4096 -> 256
I0525 11:48:05.647732 15312 hparams_lib.py:86] Overwrite key batch_size: 4096 -> 256
INFO:tensorflow:Overriding hparams in transformer_small with batch_size=256
I0525 11:48:05.647732 15312 hparams_lib.py:55] Overriding hparams in transformer_small with batch_size=256
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:844: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

W0525 11:48:05.647732 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:844: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:123: The name tf.GraphOptions is deprecated. Please use tf.compat.v1.GraphOptions instead.

W0525 11:48:05.652838 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:123: The name tf.GraphOptions is deprecated. Please use tf.compat.v1.GraphOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:129: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

W0525 11:48:05.652838 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:129: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:131: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

W0525 11:48:05.653849 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:131: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:241: RunConfig.__init__ (from tensorflow.contrib.learn.python.learn.estimators.run_config) is deprecated and will be removed in a future version.
Instructions for updating:
When switching to tf.estimator.Estimator, use tf.estimator.RunConfig instead.
W0525 11:48:05.653849 15312 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:241: RunConfig.__init__ (from tensorflow.contrib.learn.python.learn.estimators.run_config) is deprecated and will be removed in a future version.
Instructions for updating:
When switching to tf.estimator.Estimator, use tf.estimator.RunConfig instead.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:264: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0525 11:48:05.653849 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:264: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:Configuring DataParallelism to replicate the model.
I0525 11:48:05.653849 15312 trainer_lib.py:264] Configuring DataParallelism to replicate the model.
INFO:tensorflow:schedule=train
I0525 11:48:05.653849 15312 devices.py:76] schedule=train
INFO:tensorflow:worker_gpu=1
I0525 11:48:05.653849 15312 devices.py:77] worker_gpu=1
INFO:tensorflow:sync=False
I0525 11:48:05.653849 15312 devices.py:78] sync=False
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\devices.py:139: The name tf.logging.warn is deprecated. Please use tf.compat.v1.logging.warn instead.

W0525 11:48:05.653849 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\devices.py:139: The name tf.logging.warn is deprecated. Please use tf.compat.v1.logging.warn instead.

WARNING:tensorflow:Schedule=train. Assuming that training is running on a single machine.
W0525 11:48:05.653849 15312 devices.py:141] Schedule=train. Assuming that training is running on a single machine.
INFO:tensorflow:datashard_devices: ['gpu:0']
I0525 11:48:05.653849 15312 devices.py:170] datashard_devices: ['gpu:0']
INFO:tensorflow:caching_devices: None
I0525 11:48:05.653849 15312 devices.py:171] caching_devices: None
INFO:tensorflow:ps_devices: ['gpu:0']
I0525 11:48:05.653849 15312 devices.py:172] ps_devices: ['gpu:0']
I0525 11:48:05.653849 15312 merge_vocab.py:101] Loading and processing vocabulary from: C:\Users\zhang\OneDrive\Desktop\NLP\MyNLP\usr_dir/merge.txt.vocab.clean
I0525 11:48:05.653849 15312 merge_vocab.py:105] Done
INFO:tensorflow:Using config: {'_task_type': None, '_task_id': 0, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x0000021BD3A773C8>, '_master': '', '_num_ps_replicas': 0, '_num_worker_replicas': 0, '_environment': 'local', '_is_chief': True, '_evaluation_master': '', '_train_distribute': None, '_eval_distribute': None, '_experimental_max_worker_delay_secs': None, '_device_fn': None, '_tf_config': gpu_options {
  per_process_gpu_memory_fraction: 1.0
}
, '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_secs': 1800, '_log_step_count_steps': 100, '_protocol': None, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.95
}
allow_soft_placement: true
graph_options {
  optimizer_options {
    global_jit_level: OFF
  }
}
isolate_session_state: true
, '_save_checkpoints_steps': None, '_keep_checkpoint_max': 1000, '_keep_checkpoint_every_n_hours': 10000, '_model_dir': './output', '_session_creation_timeout_secs': 7200, 'use_tpu': False, 't2t_device_info': {'num_async_replicas': 1}, 'data_parallelism': <tensor2tensor.utils.expert_utils.Parallelism object at 0x0000021BD49AE5C8>}
I0525 11:48:05.657468 15312 estimator.py:212] Using config: {'_task_type': None, '_task_id': 0, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x0000021BD3A773C8>, '_master': '', '_num_ps_replicas': 0, '_num_worker_replicas': 0, '_environment': 'local', '_is_chief': True, '_evaluation_master': '', '_train_distribute': None, '_eval_distribute': None, '_experimental_max_worker_delay_secs': None, '_device_fn': None, '_tf_config': gpu_options {
  per_process_gpu_memory_fraction: 1.0
}
, '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_secs': 1800, '_log_step_count_steps': 100, '_protocol': None, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.95
}
allow_soft_placement: true
graph_options {
  optimizer_options {
    global_jit_level: OFF
  }
}
isolate_session_state: true
, '_save_checkpoints_steps': None, '_keep_checkpoint_max': 1000, '_keep_checkpoint_every_n_hours': 10000, '_model_dir': './output', '_session_creation_timeout_secs': 7200, 'use_tpu': False, 't2t_device_info': {'num_async_replicas': 1}, 'data_parallelism': <tensor2tensor.utils.expert_utils.Parallelism object at 0x0000021BD49AE5C8>}
WARNING:tensorflow:Estimator's model_fn (<function T2TModel.make_estimator_model_fn.<locals>.wrapping_model_fn at 0x0000021BD4997D38>) includes params argument, but params are not passed to Estimator.
W0525 11:48:05.657468 15312 model_fn.py:630] Estimator's model_fn (<function T2TModel.make_estimator_model_fn.<locals>.wrapping_model_fn at 0x0000021BD4997D38>) includes params argument, but params are not passed to Estimator.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:331: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

W0525 11:48:05.657468 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:331: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:348: The name tf.gfile.Open is deprecated. Please use tf.io.gfile.GFile instead.

W0525 11:48:05.657468 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:348: The name tf.gfile.Open is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
W0525 11:48:05.677511 15312 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
INFO:tensorflow:Reading data files from ./data_dir\translate_up2down-train*
I0525 11:48:05.687628 15312 problem.py:651] Reading data files from ./data_dir\translate_up2down-train*
INFO:tensorflow:partition: 0 num_data_files: 9
I0525 11:48:05.687628 15312 problem.py:677] partition: 0 num_data_files: 9
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:687: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.experimental.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_determinstic`.
W0525 11:48:05.697667 15312 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:687: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.experimental.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_determinstic`.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:712: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0525 11:48:05.847808 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:712: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.logging.warning is deprecated. Please use tf.compat.v1.logging.warning instead.

W0525 11:48:06.217401 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.logging.warning is deprecated. Please use tf.compat.v1.logging.warning instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:276: tf_record_iterator (from tensorflow.python.lib.io.tf_record) is deprecated and will be removed in a future version.
Instructions for updating:
Use eager execution and: 
`tf.data.TFRecordDataset(path)`
W0525 11:48:07.297379 15312 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:276: tf_record_iterator (from tensorflow.python.lib.io.tf_record) is deprecated and will be removed in a future version.
Instructions for updating:
Use eager execution and: 
`tf.data.TFRecordDataset(path)`
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:38: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0525 11:48:07.497457 15312 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:38: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\data\experimental\ops\grouping.py:194: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0525 11:48:07.847627 15312 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\data\experimental\ops\grouping.py:194: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

W0525 11:48:08.507596 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:234: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0525 11:48:08.697622 15312 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:234: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0525 11:48:09.077662 15312 estimator.py:1148] Calling model_fn.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1991: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

W0525 11:48:09.077662 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1991: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1994: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

W0525 11:48:09.077662 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1994: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1997: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

W0525 11:48:09.077662 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1997: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1457: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

W0525 11:48:09.097752 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1457: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

INFO:tensorflow:Setting T2TModel mode to 'train'
I0525 11:48:09.097752 15312 t2t_model.py:2262] Setting T2TModel mode to 'train'
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:100: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0525 11:48:09.097752 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:100: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:245: The name tf.summary.text is deprecated. Please use tf.compat.v1.summary.text instead.

W0525 11:48:09.207542 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:245: The name tf.summary.text is deprecated. Please use tf.compat.v1.summary.text instead.

INFO:tensorflow:Using variable initializer: uniform_unit_scaling
I0525 11:48:10.267545 15312 api.py:332] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_3606_256.bottom
I0525 11:48:21.017524 15312 api.py:332] Transforming feature 'inputs' with symbol_modality_3606_256.bottom
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
W0525 11:48:21.677734 15312 deprecation.py:506] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0525 11:48:21.957621 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

INFO:tensorflow:Transforming feature 'targets' with symbol_modality_3606_256.targets_bottom
I0525 11:48:24.408308 15312 api.py:332] Transforming feature 'targets' with symbol_modality_3606_256.targets_bottom
INFO:tensorflow:Building model body
I0525 11:48:24.577366 15312 api.py:332] Building model body
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.mod is deprecated. Please use tf.math.mod instead.

W0525 11:48:27.907474 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.mod is deprecated. Please use tf.math.mod instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py:95: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0525 11:48:28.127649 15312 deprecation.py:506] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py:95: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:Entity <function attention_bias_to_padding at 0x0000021BCDBC2CA8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 
W0525 11:48:29.137445 15312 ag_logging.py:146] Entity <function attention_bias_to_padding at 0x0000021BCDBC2CA8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.squared_difference is deprecated. Please use tf.math.squared_difference instead.

W0525 11:48:30.309337 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.squared_difference is deprecated. Please use tf.math.squared_difference instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.rsqrt is deprecated. Please use tf.math.rsqrt instead.

W0525 11:48:30.310333 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.rsqrt is deprecated. Please use tf.math.rsqrt instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

W0525 11:48:37.826826 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

W0525 11:48:37.827849 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:Entity <function layers at 0x0000021BC4557438> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: If not matching a CFG node, must be a block statement: <gast.gast.ImportFrom object at 0x0000021BD6C70B48>
W0525 11:48:38.347604 15312 ag_logging.py:146] Entity <function layers at 0x0000021BC4557438> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: If not matching a CFG node, must be a block statement: <gast.gast.ImportFrom object at 0x0000021BD6C70B48>
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:3083: The name tf.layers.Dense is deprecated. Please use tf.compat.v1.layers.Dense instead.

W0525 11:48:38.347604 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:3083: The name tf.layers.Dense is deprecated. Please use tf.compat.v1.layers.Dense instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.image is deprecated. Please use tf.compat.v1.summary.image instead.

W0525 11:48:39.737607 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.image is deprecated. Please use tf.compat.v1.summary.image instead.

INFO:tensorflow:Transforming body output with symbol_modality_3606_256.top
I0525 11:48:50.827470 15312 api.py:332] Transforming body output with symbol_modality_3606_256.top
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

W0525 11:48:52.731305 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.log is deprecated. Please use tf.math.log instead.

W0525 11:48:57.590251 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.log is deprecated. Please use tf.math.log instead.

INFO:tensorflow:Base learning rate: 2.000000
I0525 11:48:59.747108 15312 learning_rate.py:29] Base learning rate: 2.000000
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:250: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

W0525 11:48:59.798969 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:250: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

INFO:tensorflow:Trainable Variables Total size: 4612608
I0525 11:48:59.811946 15312 optimize.py:336] Trainable Variables Total size: 4612608
INFO:tensorflow:Non-trainable variables Total size: 5
I0525 11:48:59.812933 15312 optimize.py:336] Non-trainable variables Total size: 5
INFO:tensorflow:Using optimizer adam
I0525 11:48:59.813930 15312 optimize.py:191] Using optimizer adam
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:102: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

W0525 11:48:59.819914 15312 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:102: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

INFO:tensorflow:Done calling model_fn.
I0525 11:49:05.992276 15312 estimator.py:1150] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
I0525 11:49:05.994271 15312 basic_session_run_hooks.py:541] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
I0525 11:49:22.979434 15312 monitored_session.py:240] Graph was finalized.
2020-05-25 11:49:22.979993: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2
2020-05-25 11:49:22.984540: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll
2020-05-25 11:49:23.714611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce MX150 major: 6 minor: 1 memoryClockRate(GHz): 1.0375
pciBusID: 0000:01:00.0
2020-05-25 11:49:23.715295: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-05-25 11:49:23.721441: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-05-25 11:49:23.725827: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-05-25 11:49:23.727655: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-05-25 11:49:23.733090: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-05-25 11:49:23.736841: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-05-25 11:49:23.749159: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-05-25 11:49:23.750247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-05-25 11:49:24.642233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-25 11:49:24.642652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-05-25 11:49:24.642860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-05-25 11:49:24.643974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 1945 MB memory) -> physical GPU (device: 0, name: GeForce MX150, pci bus id: 0000:01:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from ./output\model.ckpt-0
I0525 11:49:24.654162 15312 saver.py:1284] Restoring parameters from ./output\model.ckpt-0
2020-05-25 11:49:25.666639: I tensorflow/stream_executor/cuda/cuda_driver.cc:831] failed to allocate 1.90G (2040109312 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-05-25 11:49:25.667546: I tensorflow/stream_executor/cuda/cuda_driver.cc:831] failed to allocate 1.71G (1836098304 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\saver.py:1069: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
W0525 11:49:25.904497 15312 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\saver.py:1069: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
INFO:tensorflow:Running local_init_op.
I0525 11:49:26.402839 15312 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0525 11:49:26.645142 15312 session_manager.py:502] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into ./output\model.ckpt.
I0525 11:49:49.637204 15312 basic_session_run_hooks.py:606] Saving checkpoints for 0 into ./output\model.ckpt.
2020-05-25 11:50:06.711860: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-05-25 11:50:06.974797: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.980097: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.980436: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.981026: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.981342: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.981656: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.985307: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.985808: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.990650: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.991033: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.993969: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.996746: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.997139: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.997507: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:06.999499: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.001350: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.002170: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.003934: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.004337: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.004736: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.005133: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.006741: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.008518: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.009360: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.011214: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.011638: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.012057: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.013719: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.015401: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.016718: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.018410: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.019287: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.020768: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.022642: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.023062: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.026553: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.026968: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.027680: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.028244: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.029676: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.030179: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.030773: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.031183: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.031872: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.032280: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.032752: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.033168: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.034531: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.035007: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.035622: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.036044: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.036704: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.037109: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.037616: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.038022: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.039600: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.040032: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.040588: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.041007: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.042371: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.042871: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.043583: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.044001: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.045071: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.045603: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.046170: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.046633: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.049281: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.049718: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.050226: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.050659: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.051351: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.051773: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.052279: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.052698: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.054042: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.054471: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.055028: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.055446: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.057287: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.057841: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.058754: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.059356: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.061273: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.061820: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.062735: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.063167: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.064709: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.065136: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.065741: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.066182: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.067999: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.068668: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.069483: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.070073: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.070860: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.071458: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.072057: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:07.072579: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:09.273907: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:09.274594: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
2020-05-25 11:50:09.274678: W tensorflow/stream_executor/stream.cc:2041] attempting to perform BLAS operation using StreamExecutor without BLAS support
2020-05-25 11:50:09.275062: W tensorflow/stream_executor/stream.cc:2041] attempting to perform BLAS operation using StreamExecutor without BLAS support
Traceback (most recent call last):
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1365, in _do_call
    return fn(*args)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1350, in _run_fn
    target_list, run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1443, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InternalError: 2 root error(s) found.
  (0) Internal: Blas GEMM launch failed : a.shape=(195, 256), b.shape=(256, 256), m=195, n=256, k=256
	 [[{{node transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul}}]]
	 [[transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/encdec_attention/multihead_attention/dot_product_attention/Max/_2299]]
  (1) Internal: Blas GEMM launch failed : a.shape=(195, 256), b.shape=(256, 256), m=195, n=256, k=256
	 [[{{node transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:/Anaconda/envs/NLP/Scripts/t2t-trainer", line 33, in <module>
    tf.app.run()
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\platform\app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "D:\Anaconda\envs\NLP\lib\site-packages\absl\app.py", line 299, in run
    _run_main(main, args)
  File "D:\Anaconda\envs\NLP\lib\site-packages\absl\app.py", line 250, in _run_main
    sys.exit(main(argv))
  File "D:/Anaconda/envs/NLP/Scripts/t2t-trainer", line 28, in main
    t2t_trainer.main(argv)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py", line 418, in main
    execute_schedule(exp)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py", line 371, in execute_schedule
    getattr(exp, FLAGS.schedule)()
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py", line 477, in train
    max_steps=max_steps or self._train_spec.max_steps)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1161, in _train_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1195, in _train_model_default
    saving_listeners)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1494, in _train_with_estimator_spec
    _, loss = mon_sess.run([estimator_spec.train_op, estimator_spec.loss])
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 754, in run
    run_metadata=run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1259, in run
    run_metadata=run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1360, in run
    raise six.reraise(*original_exc_info)
  File "D:\Anaconda\envs\NLP\lib\site-packages\six.py", line 703, in reraise
    raise value
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1345, in run
    return self._sess.run(*args, **kwargs)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1418, in run
    run_metadata=run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\monitored_session.py", line 1176, in run
    return self._sess.run(*args, **kwargs)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 956, in run
    run_metadata_ptr)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1180, in _run
    feed_dict_tensor, options, run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1359, in _do_run
    run_metadata)
  File "D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\client\session.py", line 1384, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InternalError: 2 root error(s) found.
  (0) Internal: Blas GEMM launch failed : a.shape=(195, 256), b.shape=(256, 256), m=195, n=256, k=256
	 [[node transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul (defined at \Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py:1748) ]]
	 [[transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/encdec_attention/multihead_attention/dot_product_attention/Max/_2299]]
  (1) Internal: Blas GEMM launch failed : a.shape=(195, 256), b.shape=(256, 256), m=195, n=256, k=256
	 [[node transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul (defined at \Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py:1748) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'transformer/parallel_0_5/transformer/transformer/body/decoder/layer_0/self_attention/multihead_attention/q/Tensordot/MatMul':
  File "/Anaconda/envs/NLP/Scripts/t2t-trainer", line 33, in <module>
    tf.app.run()
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\platform\app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "\Anaconda\envs\NLP\lib\site-packages\absl\app.py", line 299, in run
    _run_main(main, args)
  File "\Anaconda\envs\NLP\lib\site-packages\absl\app.py", line 250, in _run_main
    sys.exit(main(argv))
  File "/Anaconda/envs/NLP/Scripts/t2t-trainer", line 28, in main
    t2t_trainer.main(argv)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py", line 418, in main
    execute_schedule(exp)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py", line 371, in execute_schedule
    getattr(exp, FLAGS.schedule)()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py", line 477, in train
    max_steps=max_steps or self._train_spec.max_steps)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 370, in train
    loss = self._train_model(input_fn, hooks, saving_listeners)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1161, in _train_model
    return self._train_model_default(input_fn, hooks, saving_listeners)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1191, in _train_model_default
    features, labels, ModeKeys.TRAIN, self.config)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1149, in _call_model_fn
    model_fn_results = self._model_fn(features=features, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 1420, in wrapping_model_fn
    use_tpu=use_tpu)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 1485, in estimator_model_fn
    logits, losses_dict = model(features)  # pylint: disable=not-callable
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\layers\base.py", line 548, in __call__
    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\keras\engine\base_layer.py", line 854, in __call__
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 325, in call
    sharded_logits, losses = self.model_fn_sharded(sharded_features)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 365, in model_fn_sharded
    if self.use_body_sharded():
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 402, in model_fn_sharded
    sharded_logits, sharded_losses = dp(self.model_fn, datashard_to_features)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\expert_utils.py", line 171, in __call__
    for i in range(self.n):
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 339, in for_stmt
    return _py_for_stmt(iter_, extra_test, body, get_state, set_state, init_vars)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 350, in _py_for_stmt
    state = body(target, *state)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\expert_utils.py", line 229, in __call__
    if self._devices[i] != DEFAULT_DEV_STRING:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\expert_utils.py", line 231, in __call__
    outputs.append(fns[i](*my_args[i], **my_kwargs[i]))
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py", line 429, in model_fn
    body_out = self.body(transformed_features)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 277, in body
    decoder_output = self.decode(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 218, in decode
    return transformer_decode(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 161, in transformer_decode
    decoder_output = decoder_function(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 1664, in transformer_decoder
    for layer_idx in range(hparams.num_decoder_layers or
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 339, in for_stmt
    return _py_for_stmt(iter_, extra_test, body, get_state, set_state, init_vars)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 350, in _py_for_stmt
    state = body(target, *state)
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 1666, in transformer_decoder
    x = transformer_decoder_layer(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 1561, in transformer_decoder_layer
    x, layer_cache = transformer_self_attention_layer(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py", line 1465, in transformer_self_attention_layer
    y = common_attention.multihead_attention(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4649, in multihead_attention
    if cache is None or memory_antecedent is None:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4650, in multihead_attention
    q, k, v = compute_qkv(query_antecedent, memory_antecedent,
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4454, in compute_qkv
    q = compute_attention_component(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4399, in compute_attention_component
    if vars_3d_num_heads > 0:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4414, in compute_attention_component
    if filter_width == 1:
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 895, in if_stmt
    return _py_if_stmt(cond, body, orelse)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\operators\control_flow.py", line 1004, in _py_if_stmt
    return body() if cond else orelse()
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_attention.py", line 4415, in compute_attention_component
    return common_layers.dense(
  File "\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py", line 3083, in dense
    activations = layers().Dense(units, **kwargs)(x)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\layers\base.py", line 548, in __call__
    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\keras\engine\base_layer.py", line 854, in __call__
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\keras\layers\core.py", line 1039, in call
    outputs = standard_ops.tensordot(inputs, self.kernel, [[rank - 1], [0]])
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\math_ops.py", line 4071, in tensordot
    ab_matmul = matmul(a_reshape, b_reshape)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\util\dispatch.py", line 180, in wrapper
    return target(*args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\math_ops.py", line 2754, in matmul
    a, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\gen_math_ops.py", line 6136, in mat_mul
    name=name)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\op_def_library.py", line 794, in _apply_op_helper
    op_def=op_def)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\util\deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py", line 3357, in create_op
    attrs, op_def, compute_device)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py", line 3426, in _create_op_internal
    op_def=op_def)
  File "\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\framework\ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

2020-05-25 11:56:52.575052: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:187: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\research\neural_stack.py:52: The name tf.nn.rnn_cell.RNNCell is deprecated. Please use tf.compat.v1.nn.rnn_cell.RNNCell instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:111: The name tf.OptimizerOptions is deprecated. Please use tf.compat.v1.OptimizerOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:111: The name tf.OptimizerOptions is deprecated. Please use tf.compat.v1.OptimizerOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_gan\python\estimator\tpu_gan_estimator.py:42: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_gan\python\estimator\tpu_gan_estimator.py:42: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:32: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:33: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

WARNING:tensorflow:From D:/Anaconda/envs/NLP/Scripts/t2t-trainer:33: The name tf.app.run is deprecated. Please use tf.compat.v1.app.run instead.

INFO:tensorflow:Importing user module usr_dir from path C:\Users\zhang\OneDrive\Desktop\NLP\MyNLP
I0525 11:57:00.778275 14676 usr_dir.py:43] Importing user module usr_dir from path C:\Users\zhang\OneDrive\Desktop\NLP\MyNLP
INFO:tensorflow:Loading hparams from existing json ./output\hparams.json
I0525 11:57:00.778275 14676 hparams_lib.py:64] Loading hparams from existing json ./output\hparams.json
INFO:tensorflow:Overwrite key batch_size: 4096 -> 256
I0525 11:57:00.778275 14676 hparams_lib.py:86] Overwrite key batch_size: 4096 -> 256
INFO:tensorflow:Overriding hparams in transformer_small with batch_size=256
I0525 11:57:00.778275 14676 hparams_lib.py:55] Overriding hparams in transformer_small with batch_size=256
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:844: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

W0525 11:57:00.786822 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:844: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:123: The name tf.GraphOptions is deprecated. Please use tf.compat.v1.GraphOptions instead.

W0525 11:57:00.786822 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:123: The name tf.GraphOptions is deprecated. Please use tf.compat.v1.GraphOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:129: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

W0525 11:57:00.786822 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:129: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:131: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

W0525 11:57:00.786822 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:131: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:241: RunConfig.__init__ (from tensorflow.contrib.learn.python.learn.estimators.run_config) is deprecated and will be removed in a future version.
Instructions for updating:
When switching to tf.estimator.Estimator, use tf.estimator.RunConfig instead.
W0525 11:57:00.786822 14676 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:241: RunConfig.__init__ (from tensorflow.contrib.learn.python.learn.estimators.run_config) is deprecated and will be removed in a future version.
Instructions for updating:
When switching to tf.estimator.Estimator, use tf.estimator.RunConfig instead.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:264: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

W0525 11:57:00.786822 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\trainer_lib.py:264: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:Configuring DataParallelism to replicate the model.
I0525 11:57:00.786822 14676 trainer_lib.py:264] Configuring DataParallelism to replicate the model.
INFO:tensorflow:schedule=train
I0525 11:57:00.786822 14676 devices.py:76] schedule=train
INFO:tensorflow:worker_gpu=0
I0525 11:57:00.786822 14676 devices.py:77] worker_gpu=0
INFO:tensorflow:sync=False
I0525 11:57:00.786822 14676 devices.py:78] sync=False
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\devices.py:139: The name tf.logging.warn is deprecated. Please use tf.compat.v1.logging.warn instead.

W0525 11:57:00.786822 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\devices.py:139: The name tf.logging.warn is deprecated. Please use tf.compat.v1.logging.warn instead.

WARNING:tensorflow:Schedule=train. Assuming that training is running on a single machine.
W0525 11:57:00.786822 14676 devices.py:141] Schedule=train. Assuming that training is running on a single machine.
INFO:tensorflow:datashard_devices: ['cpu:0']
I0525 11:57:00.786822 14676 devices.py:170] datashard_devices: ['cpu:0']
INFO:tensorflow:caching_devices: None
I0525 11:57:00.786822 14676 devices.py:171] caching_devices: None
INFO:tensorflow:ps_devices: ['']
I0525 11:57:00.786822 14676 devices.py:172] ps_devices: ['']
I0525 11:57:00.786822 14676 merge_vocab.py:101] Loading and processing vocabulary from: C:\Users\zhang\OneDrive\Desktop\NLP\MyNLP\usr_dir/merge.txt.vocab.clean
I0525 11:57:00.786822 14676 merge_vocab.py:105] Done
INFO:tensorflow:Using config: {'_task_type': None, '_task_id': 0, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x000001C24A178DC8>, '_master': '', '_num_ps_replicas': 0, '_num_worker_replicas': 0, '_environment': 'local', '_is_chief': True, '_evaluation_master': '', '_train_distribute': None, '_eval_distribute': None, '_experimental_max_worker_delay_secs': None, '_device_fn': None, '_tf_config': gpu_options {
  per_process_gpu_memory_fraction: 1.0
}
, '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_secs': 1800, '_log_step_count_steps': 100, '_protocol': None, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.95
}
allow_soft_placement: true
graph_options {
  optimizer_options {
    global_jit_level: OFF
  }
}
isolate_session_state: true
, '_save_checkpoints_steps': None, '_keep_checkpoint_max': 1000, '_keep_checkpoint_every_n_hours': 10000, '_model_dir': './output', '_session_creation_timeout_secs': 7200, 'use_tpu': False, 't2t_device_info': {'num_async_replicas': 1}, 'data_parallelism': <tensor2tensor.utils.expert_utils.Parallelism object at 0x000001C24A5FEA88>}
I0525 11:57:00.786822 14676 estimator.py:212] Using config: {'_task_type': None, '_task_id': 0, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x000001C24A178DC8>, '_master': '', '_num_ps_replicas': 0, '_num_worker_replicas': 0, '_environment': 'local', '_is_chief': True, '_evaluation_master': '', '_train_distribute': None, '_eval_distribute': None, '_experimental_max_worker_delay_secs': None, '_device_fn': None, '_tf_config': gpu_options {
  per_process_gpu_memory_fraction: 1.0
}
, '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_secs': 1800, '_log_step_count_steps': 100, '_protocol': None, '_session_config': gpu_options {
  per_process_gpu_memory_fraction: 0.95
}
allow_soft_placement: true
graph_options {
  optimizer_options {
    global_jit_level: OFF
  }
}
isolate_session_state: true
, '_save_checkpoints_steps': None, '_keep_checkpoint_max': 1000, '_keep_checkpoint_every_n_hours': 10000, '_model_dir': './output', '_session_creation_timeout_secs': 7200, 'use_tpu': False, 't2t_device_info': {'num_async_replicas': 1}, 'data_parallelism': <tensor2tensor.utils.expert_utils.Parallelism object at 0x000001C24A5FEA88>}
WARNING:tensorflow:Estimator's model_fn (<function T2TModel.make_estimator_model_fn.<locals>.wrapping_model_fn at 0x000001C24A5E7D38>) includes params argument, but params are not passed to Estimator.
W0525 11:57:00.786822 14676 model_fn.py:630] Estimator's model_fn (<function T2TModel.make_estimator_model_fn.<locals>.wrapping_model_fn at 0x000001C24A5E7D38>) includes params argument, but params are not passed to Estimator.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:331: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

W0525 11:57:00.786822 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:331: The name tf.gfile.Exists is deprecated. Please use tf.io.gfile.exists instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:348: The name tf.gfile.Open is deprecated. Please use tf.io.gfile.GFile instead.

W0525 11:57:00.786822 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\bin\t2t_trainer.py:348: The name tf.gfile.Open is deprecated. Please use tf.io.gfile.GFile instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
W0525 11:57:00.826763 14676 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
INFO:tensorflow:Reading data files from ./data_dir\translate_up2down-train*
I0525 11:57:00.848706 14676 problem.py:651] Reading data files from ./data_dir\translate_up2down-train*
INFO:tensorflow:partition: 0 num_data_files: 9
I0525 11:57:00.854689 14676 problem.py:677] partition: 0 num_data_files: 9
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:687: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.experimental.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_determinstic`.
W0525 11:57:00.861672 14676 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:687: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.experimental.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_determinstic`.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:712: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

W0525 11:57:01.079123 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\data_generators\problem.py:712: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.logging.warning is deprecated. Please use tf.compat.v1.logging.warning instead.

W0525 11:57:01.468799 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.logging.warning is deprecated. Please use tf.compat.v1.logging.warning instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:276: tf_record_iterator (from tensorflow.python.lib.io.tf_record) is deprecated and will be removed in a future version.
Instructions for updating:
Use eager execution and: 
`tf.data.TFRecordDataset(path)`
W0525 11:57:02.851418 14676 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:276: tf_record_iterator (from tensorflow.python.lib.io.tf_record) is deprecated and will be removed in a future version.
Instructions for updating:
Use eager execution and: 
`tf.data.TFRecordDataset(path)`
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:38: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0525 11:57:03.081808 14676 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:38: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\data\experimental\ops\grouping.py:194: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
W0525 11:57:03.508667 14676 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\data\experimental\ops\grouping.py:194: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

W0525 11:57:04.240983 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:234: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0525 11:57:04.473374 14676 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\data_reader.py:234: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Calling model_fn.
I0525 11:57:04.892309 14676 estimator.py:1148] Calling model_fn.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1991: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

W0525 11:57:04.893324 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1991: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1994: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

W0525 11:57:04.893324 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1994: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1997: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

W0525 11:57:04.893324 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1997: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1457: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

W0525 11:57:04.910244 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:1457: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

INFO:tensorflow:Setting T2TModel mode to 'train'
I0525 11:57:04.911244 14676 t2t_model.py:2262] Setting T2TModel mode to 'train'
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:100: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0525 11:57:04.911244 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:100: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:245: The name tf.summary.text is deprecated. Please use tf.compat.v1.summary.text instead.

W0525 11:57:05.035908 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\t2t_model.py:245: The name tf.summary.text is deprecated. Please use tf.compat.v1.summary.text instead.

INFO:tensorflow:Using variable initializer: uniform_unit_scaling
I0525 11:57:06.230716 14676 api.py:332] Using variable initializer: uniform_unit_scaling
INFO:tensorflow:Transforming feature 'inputs' with symbol_modality_3606_256.bottom
I0525 11:57:18.758259 14676 api.py:332] Transforming feature 'inputs' with symbol_modality_3606_256.bottom
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
W0525 11:57:19.445354 14676 deprecation.py:506] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\ops\resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0525 11:57:19.719281 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

INFO:tensorflow:Transforming feature 'targets' with symbol_modality_3606_256.targets_bottom
I0525 11:57:22.690776 14676 api.py:332] Transforming feature 'targets' with symbol_modality_3606_256.targets_bottom
INFO:tensorflow:Building model body
I0525 11:57:22.949037 14676 api.py:332] Building model body
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.mod is deprecated. Please use tf.math.mod instead.

W0525 11:57:26.448651 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.mod is deprecated. Please use tf.math.mod instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py:95: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0525 11:57:26.690047 14676 deprecation.py:506] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\models\transformer.py:95: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:Entity <function attention_bias_to_padding at 0x000001C243813CA8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 
W0525 11:57:27.783247 14676 ag_logging.py:146] Entity <function attention_bias_to_padding at 0x000001C243813CA8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: 
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.squared_difference is deprecated. Please use tf.math.squared_difference instead.

W0525 11:57:28.897196 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.squared_difference is deprecated. Please use tf.math.squared_difference instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.rsqrt is deprecated. Please use tf.math.rsqrt instead.

W0525 11:57:28.898151 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.rsqrt is deprecated. Please use tf.math.rsqrt instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

W0525 11:57:34.394026 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

W0525 11:57:34.394026 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

WARNING:tensorflow:Entity <function layers at 0x000001C23A1A7438> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: If not matching a CFG node, must be a block statement: <gast.gast.ImportFrom object at 0x000001C24BD5DFC8>
W0525 11:57:34.758885 14676 ag_logging.py:146] Entity <function layers at 0x000001C23A1A7438> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: If not matching a CFG node, must be a block statement: <gast.gast.ImportFrom object at 0x000001C24BD5DFC8>
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:3083: The name tf.layers.Dense is deprecated. Please use tf.compat.v1.layers.Dense instead.

W0525 11:57:34.759882 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\layers\common_layers.py:3083: The name tf.layers.Dense is deprecated. Please use tf.compat.v1.layers.Dense instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.image is deprecated. Please use tf.compat.v1.summary.image instead.

W0525 11:57:36.080560 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.image is deprecated. Please use tf.compat.v1.summary.image instead.

INFO:tensorflow:Transforming body output with symbol_modality_3606_256.top
I0525 11:57:45.063017 14676 api.py:332] Transforming body output with symbol_modality_3606_256.top
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

W0525 11:57:47.150181 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.log is deprecated. Please use tf.math.log instead.

W0525 11:57:51.382382 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\autograph\converters\directives.py:119: The name tf.log is deprecated. Please use tf.math.log instead.

INFO:tensorflow:Base learning rate: 2.000000
I0525 11:57:53.257367 14676 learning_rate.py:29] Base learning rate: 2.000000
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:250: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

W0525 11:57:53.267340 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:250: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

INFO:tensorflow:Trainable Variables Total size: 4612608
I0525 11:57:53.271373 14676 optimize.py:336] Trainable Variables Total size: 4612608
INFO:tensorflow:Non-trainable variables Total size: 5
I0525 11:57:53.271373 14676 optimize.py:336] Non-trainable variables Total size: 5
INFO:tensorflow:Using optimizer adam
I0525 11:57:53.271373 14676 optimize.py:191] Using optimizer adam
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:102: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

W0525 11:57:53.273366 14676 module_wrapper.py:139] From D:\Anaconda\envs\NLP\lib\site-packages\tensor2tensor\utils\optimize.py:102: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

INFO:tensorflow:Done calling model_fn.
I0525 11:57:58.103446 14676 estimator.py:1150] Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
I0525 11:57:58.105439 14676 basic_session_run_hooks.py:541] Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
I0525 11:58:13.616614 14676 monitored_session.py:240] Graph was finalized.
2020-05-25 11:58:13.618599: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2
2020-05-25 11:58:13.624696: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll
2020-05-25 11:58:14.298688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: GeForce MX150 major: 6 minor: 1 memoryClockRate(GHz): 1.0375
pciBusID: 0000:01:00.0
2020-05-25 11:58:14.299324: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll
2020-05-25 11:58:14.306066: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll
2020-05-25 11:58:14.318131: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll
2020-05-25 11:58:14.321034: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll
2020-05-25 11:58:14.333528: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll
2020-05-25 11:58:14.340020: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll
2020-05-25 11:58:14.359113: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-05-25 11:58:14.361925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-05-25 11:58:15.296625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-25 11:58:15.296923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-05-25 11:58:15.297101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-05-25 11:58:15.298276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 1945 MB memory) -> physical GPU (device: 0, name: GeForce MX150, pci bus id: 0000:01:00.0, compute capability: 6.1)
INFO:tensorflow:Restoring parameters from ./output\model.ckpt-0
I0525 11:58:15.305536 14676 saver.py:1284] Restoring parameters from ./output\model.ckpt-0
2020-05-25 11:58:16.418027: I tensorflow/stream_executor/cuda/cuda_driver.cc:831] failed to allocate 1.90G (2040109312 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2020-05-25 11:58:16.418594: I tensorflow/stream_executor/cuda/cuda_driver.cc:831] failed to allocate 1.71G (1836098304 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
WARNING:tensorflow:From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\saver.py:1069: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
W0525 11:58:16.579994 14676 deprecation.py:323] From D:\Anaconda\envs\NLP\lib\site-packages\tensorflow_core\python\training\saver.py:1069: get_checkpoint_mtimes (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file utilities to get mtimes.
INFO:tensorflow:Running local_init_op.
I0525 11:58:17.080203 14676 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0525 11:58:17.313626 14676 session_manager.py:502] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into ./output\model.ckpt.
I0525 11:58:41.469768 14676 basic_session_run_hooks.py:606] Saving checkpoints for 0 into ./output\model.ckpt.
INFO:tensorflow:loss = 7.8277636, step = 0
I0525 11:58:56.627700 14676 basic_session_run_hooks.py:262] loss = 7.8277636, step = 0
INFO:tensorflow:global_step/sec: 5.99998
I0525 11:59:13.296517 14676 basic_session_run_hooks.py:692] global_step/sec: 5.99998
INFO:tensorflow:loss = 6.9829235, step = 100 (16.669 sec)
I0525 11:59:13.296517 14676 basic_session_run_hooks.py:260] loss = 6.9829235, step = 100 (16.669 sec)
INFO:tensorflow:global_step/sec: 6.72963
I0525 11:59:28.151090 14676 basic_session_run_hooks.py:692] global_step/sec: 6.72963
INFO:tensorflow:loss = 6.1036863, step = 200 (14.860 sec)
I0525 11:59:28.156165 14676 basic_session_run_hooks.py:260] loss = 6.1036863, step = 200 (14.860 sec)
INFO:tensorflow:global_step/sec: 6.75888
I0525 11:59:42.946442 14676 basic_session_run_hooks.py:692] global_step/sec: 6.75888
INFO:tensorflow:loss = 5.992327, step = 300 (14.800 sec)
I0525 11:59:42.956521 14676 basic_session_run_hooks.py:260] loss = 5.992327, step = 300 (14.800 sec)
INFO:tensorflow:global_step/sec: 6.58549
I0525 11:59:58.131339 14676 basic_session_run_hooks.py:692] global_step/sec: 6.58549
INFO:tensorflow:loss = 5.847776, step = 400 (15.180 sec)
I0525 11:59:58.136360 14676 basic_session_run_hooks.py:260] loss = 5.847776, step = 400 (15.180 sec)
INFO:tensorflow:global_step/sec: 6.3272
I0525 12:00:13.936115 14676 basic_session_run_hooks.py:692] global_step/sec: 6.3272
INFO:tensorflow:loss = 5.7439957, step = 500 (15.815 sec)
I0525 12:00:13.951446 14676 basic_session_run_hooks.py:260] loss = 5.7439957, step = 500 (15.815 sec)
INFO:tensorflow:global_step/sec: 6.82367
I0525 12:00:28.590990 14676 basic_session_run_hooks.py:692] global_step/sec: 6.82367
INFO:tensorflow:loss = 5.659102, step = 600 (14.645 sec)
I0525 12:00:28.596064 14676 basic_session_run_hooks.py:260] loss = 5.659102, step = 600 (14.645 sec)
INFO:tensorflow:global_step/sec: 6.00404
I0525 12:00:45.246431 14676 basic_session_run_hooks.py:692] global_step/sec: 6.00404
INFO:tensorflow:loss = 5.4433126, step = 700 (16.660 sec)
I0525 12:00:45.256366 14676 basic_session_run_hooks.py:260] loss = 5.4433126, step = 700 (16.660 sec)
INFO:tensorflow:global_step/sec: 5.55871
I0525 12:01:03.236222 14676 basic_session_run_hooks.py:692] global_step/sec: 5.55871
INFO:tensorflow:loss = 5.2777214, step = 800 (17.980 sec)
I0525 12:01:03.236222 14676 basic_session_run_hooks.py:260] loss = 5.2777214, step = 800 (17.980 sec)
INFO:tensorflow:global_step/sec: 5.67531
I0525 12:01:20.856397 14676 basic_session_run_hooks.py:692] global_step/sec: 5.67531
INFO:tensorflow:loss = 5.3699336, step = 900 (17.620 sec)
I0525 12:01:20.856397 14676 basic_session_run_hooks.py:260] loss = 5.3699336, step = 900 (17.620 sec)
INFO:tensorflow:global_step/sec: 5.06339
I0525 12:01:40.605998 14676 basic_session_run_hooks.py:692] global_step/sec: 5.06339
INFO:tensorflow:loss = 5.6427608, step = 1000 (19.760 sec)
I0525 12:01:40.616034 14676 basic_session_run_hooks.py:260] loss = 5.6427608, step = 1000 (19.760 sec)
INFO:tensorflow:global_step/sec: 6.38977
I0525 12:01:56.256004 14676 basic_session_run_hooks.py:692] global_step/sec: 6.38977
INFO:tensorflow:loss = 5.1195273, step = 1100 (15.640 sec)
I0525 12:01:56.256004 14676 basic_session_run_hooks.py:260] loss = 5.1195273, step = 1100 (15.640 sec)
INFO:tensorflow:global_step/sec: 6.93321
I0525 12:02:10.679339 14676 basic_session_run_hooks.py:692] global_step/sec: 6.93321
INFO:tensorflow:loss = 4.947152, step = 1200 (14.430 sec)
I0525 12:02:10.685867 14676 basic_session_run_hooks.py:260] loss = 4.947152, step = 1200 (14.430 sec)
INFO:tensorflow:global_step/sec: 6.23174
I0525 12:02:26.726234 14676 basic_session_run_hooks.py:692] global_step/sec: 6.23174
INFO:tensorflow:loss = 5.3114476, step = 1300 (16.050 sec)
I0525 12:02:26.736034 14676 basic_session_run_hooks.py:260] loss = 5.3114476, step = 1300 (16.050 sec)
INFO:tensorflow:global_step/sec: 5.17604
I0525 12:02:46.055996 14676 basic_session_run_hooks.py:692] global_step/sec: 5.17604
INFO:tensorflow:loss = 4.746164, step = 1400 (19.320 sec)
I0525 12:02:46.055996 14676 basic_session_run_hooks.py:260] loss = 4.746164, step = 1400 (19.320 sec)
INFO:tensorflow:global_step/sec: 6.05696
I0525 12:03:02.555956 14676 basic_session_run_hooks.py:692] global_step/sec: 6.05696
INFO:tensorflow:loss = 5.051785, step = 1500 (16.510 sec)
I0525 12:03:02.566090 14676 basic_session_run_hooks.py:260] loss = 5.051785, step = 1500 (16.510 sec)
INFO:tensorflow:global_step/sec: 6.07529
I0525 12:03:19.016067 14676 basic_session_run_hooks.py:692] global_step/sec: 6.07529
INFO:tensorflow:loss = 4.9372888, step = 1600 (16.450 sec)
I0525 12:03:19.016067 14676 basic_session_run_hooks.py:260] loss = 4.9372888, step = 1600 (16.450 sec)
INFO:tensorflow:global_step/sec: 6.30529
I0525 12:03:34.875770 14676 basic_session_run_hooks.py:692] global_step/sec: 6.30529
INFO:tensorflow:loss = 4.768527, step = 1700 (15.860 sec)
I0525 12:03:34.875770 14676 basic_session_run_hooks.py:260] loss = 4.768527, step = 1700 (15.860 sec)
INFO:tensorflow:global_step/sec: 6.37754
I0525 12:03:50.555807 14676 basic_session_run_hooks.py:692] global_step/sec: 6.37754
INFO:tensorflow:loss = 4.5792427, step = 1800 (15.690 sec)
I0525 12:03:50.565741 14676 basic_session_run_hooks.py:260] loss = 4.5792427, step = 1800 (15.690 sec)
INFO:tensorflow:global_step/sec: 6.04219
I0525 12:04:07.106090 14676 basic_session_run_hooks.py:692] global_step/sec: 6.04219
INFO:tensorflow:loss = 4.2044525, step = 1900 (16.540 sec)
I0525 12:04:07.106090 14676 basic_session_run_hooks.py:260] loss = 4.2044525, step = 1900 (16.540 sec)
INFO:tensorflow:Saving checkpoints for 2000 into ./output\model.ckpt.
I0525 12:04:29.411476 14676 basic_session_run_hooks.py:606] Saving checkpoints for 2000 into ./output\model.ckpt.
INFO:tensorflow:Loss for final step: 4.3170867.
I0525 12:04:42.293249 14676 estimator.py:371] Loss for final step: 4.3170867.
